# ==========================
# Configuraci贸n WebDriver
# ==========================
webdriver {
  driver = chrome
  timeouts {
    implicitlywait = 10000
    fluentwait = 30000
    wait.for.timeout = 30000
  }
  capabilities {
    browserName = "chrome"
    "goog:chromeOptions" {
      args = [
        "start-maximized",
        "test-type",
        "ignore-certificate-errors",
        "incognito",
        "disable-infobars",
        "disable-gpu",
        "disable-extensions",
        "disable-default-apps",
        "disable-popup-blocking",
        "remote-allow-origins=*",
        "disable-web-security",
        "allow-running-insecure-content"
      ]
    }
  }
}

# ==========================
# Entornos disponibles
# ==========================
environments {

  # Default (ejecuci贸n local normal)
  default {
    webdriver.base.url = "https://opencart.abstracta.us/index.php"
  }

  dev {
    webdriver.base.url = "https://dev.miapp.com"
  }

  qa {
    webdriver.base.url = "https://qa.miapp.com"
  }

  prod {
    webdriver.base.url = "https://miapp.com"
  }

  # Ejecuci贸n en CI/CD (headless)
  ci {
    webdriver {
      driver = "chrome"
      capabilities {
        "goog:chromeOptions" {
          args = [
            "headless=new",
            "no-sandbox",
            "disable-dev-shm-usage",
            "window-size=1920,1080",
            "disable-gpu",
            "disable-extensions"
          ]
        }
      }
    }
    serenity {
      project.name = "Mi Proyecto Serenity - CI"
    }
    webdriver.base.url = "https://opencart.abstracta.us/index.php"
  }

  # BrowserStack remoto
  browserstack {
    webdriver {
      driver = "remote"
      remote {
        url = "https://adrianmatos_TOh96v:jJAYurWdyEwCvYBtdcws@hub-cloud.browserstack.com/wd/hub"
      }
      capabilities {
        browserName = "Chrome"
        browserVersion = "latest"
        "bstack:options" {
          os = "Windows"
          osVersion = "11"
          buildName = "Serenity-Cucumber-Build-01"
          sessionName = "Serenity Test on BrowserStack"
          debug = true
          networkLogs = true
          seleniumVersion = "4.21.0"
        }
      }
    }
    serenity {
      project.name = "Mi Proyecto Serenity en BrowserStack"
    }
    webdriver.base.url = "https://opencart.abstracta.us/index.php"
  }

  # Selenium Grid (Docker u otro)
  grid {
    webdriver {
      driver = "remote"
      remote {
        url = "http://selenium-hub:4444/wd/hub"
      }
      capabilities {
        browserName = "chrome"
        "goog:chromeOptions" {
          args = [
            "start-maximized",
            "test-type",
            "ignore-certificate-errors",
            "allow-insecure-localhost",
            "no-sandbox",
            "disable-dev-shm-usage",
            "incognito",
            "disable-infobars",
            "disable-gpu",
            "disable-extensions",
            "disable-default-apps",
            "disable-popup-blocking",
            "disable-web-security",
            "allow-running-insecure-content",
            "remote-allow-origins=*"
          ]
        }
      }
    }
    serenity {
      project.name = "Mi Proyecto Serenity en Selenium Grid"
    }
    webdriver.base.url = "https://opencart.abstracta.us/index.php"
  }
}

# ==========================
# Configuraci贸n global Serenity
# ==========================
serenity {
  requirement {
    types = "epic, feature"
  }
  project.name = "Mi Proyecto Serenity"
  encoding = "UTF-8"
  compress.filenames = true
  take.screenshots = FOR_EACH_ACTION
  only.save.failing.screenshots = false
  report.encoding = "UTF8"
  console.colors = true
  logging = VERBOSE
  verbose = true
  restart.browser.each.scenario = true
  browser.maximized = true
  report.timezone = "America/Lima"
  reports {
    show.step.details = true
    show.manual.tests = true
    show.releases = true
    show.progress = true
    show.history = true
    accessibility = true
    durations = true
    single-page-html-report = false
  }
  dry.run = false
  skip.javascript.error.checking = true
  outputDirectory = target/site/serenity
  linked.tags = "issue,epic,story,feature"
  step.delay = 0
  extension.packages = "net.serenitybdd.core.reports"
}
